<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Karl Ropkins" />

<meta name="date" content="2021-05-07" />

<title>Introduction to R:pems.utils</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to R:pems.utils</h1>
<h4 class="author">Karl Ropkins</h4>
<h4 class="date">2021-05-07</h4>



<div id="rpems.utils" class="section level1">
<h1>R:pems.utils</h1>
<p>The <strong>R</strong> package <strong>pems.utils</strong> was developed as part of work on a series of vehicle emissions measurement studies, and originally intended for use with datasets collected using Portable Emission Measurement Systems or PEMS.</p>
<blockquote>
<p>This note assumes you already have <strong>R</strong>. If not and anything here is of interest, <strong>R</strong> is open-source and free-to-distribute, and you can get it from <a href="https://www.r-project.org/" target="_blank">[&gt;the R Project]</a>.</p>
</blockquote>
<blockquote>
<p>For those that are unfamiliar with them, PEMS are on-board systems that measure the emissions of in-use vehicles. PEMS data collection is one of a number of methods developed to provide real-world alternatives to laboratory-based emissions measurement methods traditionally used in regulatory practices. <a href="https://en.wikipedia.org/wiki/Portable_emissions_measurement_system" target="_blank">[&gt;for further information]</a></p>
</blockquote>
<p>The rationale behind <strong>pems.utils</strong> was two-fold:</p>
<ol style="list-style-type: decimal">
<li>To streamline mundane, laborious and often error-prone elements of routine data handling; and,</li>
<li>To provide mobile data users with higher-level tools for the analysis of in-journey data.</li>
</ol>
<blockquote>
<p>Although originally intended for use with PEMS data, <strong>pems.utils</strong> has also been used with datasets collected with other mobile systems. So, if you are working with time-series collected by any moving objects, <strong>pems.utils</strong> may also be of interest.</p>
</blockquote>
<blockquote>
<p>If you use <strong>pems.utils</strong>, I hope it makes your work easier, better or maybe even both.</p>
</blockquote>
<blockquote>
<p>If you have any suggestions how to make pems.utils better or you have any problems using it, please let me know. <a href="mailto:karl.ropkins@gmail.com">[&gt;email me]</a>.</p>
</blockquote>
</div>
<div id="getting-pems.utils" class="section level1">
<h1>Getting pems.utils</h1>
<p>Installing <strong>pems.utils</strong> from <strong>R</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Release version from main archive CRAN:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pems.utils&quot;</span>) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Developer&#39;s version from r-forge:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pems.utils&quot;</span>, <span class="at">repos=</span><span class="st">&quot;http://R-Forge.R-project.org&quot;</span>)</span></code></pre></div>
<p>Loading <strong>pems.utils</strong>, once it is installed:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pems.utils) </span></code></pre></div>
</div>
<div id="pems-data-structures" class="section level1">
<h1>PEMS Data Structures</h1>
<p><strong>pems.utils</strong> uses two data types, <strong>pems</strong> and <strong>pems.element</strong>s, to manage data structure like units and meta information. <strong>pems.utils</strong> includes <strong>pems.1</strong> as an example <strong>pems</strong> object:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span></span></code></pre></div>
<pre><code>## pems (1000x25)
##               time.stamp  local.time  conc.co  conc.co2  conc.hc  conc.nox
##        [Y-M-D H:M:S GMT]         [s]   [vol%]    [vol%]  [ppmC6]     [ppm]
##   1  2005-09-08 11:46:07           0        0         0        0    20.447
##   2  2005-09-08 11:46:08           1        0         0        0    21.973
##   3  2005-09-08 11:46:09           2        0         0        0    20.752
##   4  2005-09-08 11:46:10           3        0         0        0    22.583
##   5  2005-09-08 11:46:11           4        0         0        0    20.142
##   6  2005-09-08 11:46:12           5        0         0        0    20.142
##  ... not showing: 994 rows; 19 cols (elements) 
##  ... other cols: afr; exh.flow.rate[L/min]; exh.temp[degC]; exh.press[kPa];
##       amb.temp[degC]; amb.press[kPa]; amb.humidity[%]; velocity[km/h];
##       revolution[rpm]; option.1[V]; option2[V]; option.3[V];
##       latitude[d.degLat]; longitude[d.degLon]; altitude[m];
##       gps.velocity[km/h]; satellite; n.s; w.e</code></pre>
<p>Like a <strong>data.frame</strong>, the <strong>pems</strong> object contains named data-series as columns. However, unlike a <strong>data.frame</strong>:</p>
<ul>
<li>It associates units with each column. For example, the first column, <strong>time.stamp</strong> has units of <em>Y-M-D H:M:S GMT</em>, reported in the second row of the print output.</li>
<li>By default, it limits displayed data to a screen-friendly range and a summary report of other columns and rows. This is a nice idea from <strong>tibbles</strong> for the tidy handling of larger datasets <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html" target="_blank">[&gt;for more about tibbles]</a></li>
<li>All the columns in a <strong>pems</strong> object are <strong>pems.elements</strong>.</li>
</ul>
<p><strong>pems.elements</strong> can be extract from <strong>pems</strong> using <strong>$</strong> and <strong>[.]</strong> operators, for example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>time.stamp</span></code></pre></div>
<pre><code>## pems.element [n=1000]
##    [1] &quot;2005-09-08 11:46:07 GMT&quot; &quot;2005-09-08 11:46:08 GMT&quot;
##    [3] &quot;2005-09-08 11:46:09 GMT&quot; &quot;2005-09-08 11:46:10 GMT&quot;
##    [5] &quot;2005-09-08 11:46:11 GMT&quot; &quot;2005-09-08 11:46:12 GMT&quot;
##    ... not showing: 497 rows
##    ... &lt;POSIXct,POSIXt&gt; time.stamp [Y-M-D H:M:S GMT]</code></pre>
<p><strong>pems.element</strong>s act like other vectors but, like <strong>pems</strong>, track units and limits the default print range to prevent long data-series filling the screen.</p>
<blockquote>
<p>See <a href="http://pems.r-forge.r-project.org/pems.utils.operators.html">[&gt;pems.utils operators]</a> for more about operators.</p>
</blockquote>
<blockquote>
<p>See also <code>print</code> in <a href="http://pems.r-forge.r-project.org/pems.utils.generics.html">[&gt;pems.utils generics]</a> or R help documentation (?pems.generics) for more about print report management.</p>
</blockquote>
</div>
<div id="importing-pems-data" class="section level1">
<h1>Importing PEMS Data</h1>
<p>You can make <strong>pems</strong> and <strong>pems.elements</strong> objects using <strong>pems()</strong> and <strong>pems.element()</strong>, but you are more likely to import PEMS data from a file previously logged by a PEMS or other mobile measurement system.</p>
<p>A family of <strong>import2PEMS()</strong> functions are included in <strong>pems.utils</strong> for such work. These are typically used in the form:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>my.pems <span class="ot">&lt;-</span> <span class="fu">import2PEMS</span>()</span></code></pre></div>
<blockquote>
<p>See <a href="http://pems.r-forge.r-project.org/pems.utils.input.output.html">[&gt;pems.utils input/output]</a> or R help documentation (?import2PEMS) for further details.</p>
</blockquote>
</div>
<div id="pems-data-handling" class="section level1">
<h1>PEMS Data Handling</h1>
<p><strong>pems</strong> and <strong>pems.element</strong> objects can be handled like <strong>data.frames</strong> and <strong>vectors</strong>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first three rows and two columns of pems.1 </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span>[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>## pems (3x2)
##               time.stamp  local.time
##        [Y-M-D H:M:S GMT]         [s]
##   1  2005-09-08 11:46:07           0
##   2  2005-09-08 11:46:08           1
##   3  2005-09-08 11:46:09           2</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#15th to 25th velocity records in pems.1 </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span>[<span class="dv">15</span><span class="sc">:</span><span class="dv">25</span>, <span class="st">&quot;velocity&quot;</span>]</span></code></pre></div>
<pre><code>## pems.element [n=11]
##  [1] 0.1 0.3 0.2 0.3 0.2 0.4 0.1 0.2 0.2 0.1 0.1
##  ... &lt;numeric&gt; velocity [km/h]</code></pre>
<p>They are however a little stricter, for example:</p>
<ul>
<li>Calling part of <strong>pems</strong> object that does not exist generates an error rather than a <code>NULL</code>.</li>
<li>An added element does not wrap, unless specifically told to.
<ul>
<li>So, <code>pems.1$new &lt;- 1</code> would add a <strong>pems.element</strong> called <strong>new</strong> to <strong>pems.1</strong> which contained a ‘1’ followed by row a ’NA’s rather than a row of ’1’s.</li>
</ul></li>
</ul>
<blockquote>
<p><em>Why did we do this?</em> PEMS and other mobile data sources are typically contiguous data-series, each record following the one before in time order. If we align two datasets we rarely want data logged in shorter datasets wrapped and repeated alongside more than one row in longer datasets.</p>
</blockquote>
<p>You can modify and calculate new data-series manually using <strong>R</strong>, but functions are also included in <strong>pems.utils</strong> for many common mobile data conversions and parameter calculations, for example:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>velocity</span></code></pre></div>
<pre><code>## pems.element [n=1000]
##    [1]  0.1  0.1  0.3  0.3  0.2  0.4  0.3  0.7  0.1  0.2  0.2  0.2  0.1  0.2
##   [15]  0.1  0.3  0.2  0.3  0.2  0.4  0.1  0.2  0.2  0.1  0.1  0.1  0.3  0.2
##   [29]  0.1  0.1  0.2  0.3  0.4  0.1  0.3  0.4  0.1  0.4  0.2  0.2  0.1  0.2
##    ... not showing: 69 rows
##    ... &lt;numeric&gt; velocity [km/h]</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert pems.1$velocity units to miles per hour</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">convertUnits</span>(pems<span class="fl">.1</span><span class="sc">$</span>velocity, <span class="at">to=</span><span class="st">&quot;mi/h&quot;</span>)</span></code></pre></div>
<pre><code>## pems.element [n=1000]
##    [1]  0.06213712  0.06213712  0.18641136  0.18641136  0.12427424  0.24854848
##    [7]  0.18641136  0.43495983  0.06213712  0.12427424  0.12427424  0.12427424
##   [13]  0.06213712  0.12427424  0.06213712  0.18641136  0.12427424  0.18641136
##    ... not showing: 164 rows
##    ... &lt;numeric&gt; pems.1$velocity [mi/h]</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate acceleration and add to pems.1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>accel <span class="ot">&lt;-</span> <span class="fu">calcAccel</span>(velocity, local.time, pems<span class="fl">.1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>accel</span></code></pre></div>
<pre><code>## pems.element [n=1000]
##    [1]          NA  0.00000000  0.05555556  0.00000000 -0.02777778  0.05555556
##    [7] -0.02777778  0.11111111 -0.16666667  0.02777778  0.00000000  0.00000000
##   [13] -0.02777778  0.02777778 -0.02777778  0.05555556 -0.02777778  0.02777778
##    ... not showing: 164 rows
##    ... &lt;numeric&gt; accel [m/s/s]</code></pre>
<blockquote>
<p>See <a href="http://pems.r-forge.r-project.org/pems.utils.operators.html">[&gt;pems.utils operators]</a> and <a href="http://pems.r-forge.r-project.org/pems.utils.generics.html">[&gt;pems.utils generics]</a> or R help documentation for more about general <strong>pems</strong> handling.</p>
</blockquote>
<blockquote>
<p>See <a href="http://pems.r-forge.r-project.org/pems.utils.units.html">[&gt;pems.utils units]</a> or R help documentation (?pems.units) for more about <strong>pems</strong> units handling.</p>
</blockquote>
</div>
<div id="pems-data-analysis" class="section level1">
<h1>PEMS Data Analysis</h1>
<p>We can use such functions to quickly process and analysis PEMS data, for example:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate VSP and CO2 emissions and add both to pems.1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>vsp <span class="ot">&lt;-</span> <span class="fu">calcVSP</span>(velocity, <span class="at">time =</span> local.time, <span class="at">data =</span> pems<span class="fl">.1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>em.co2 <span class="ot">&lt;-</span> <span class="fu">calcEm</span>(conc.co2, <span class="at">data =</span> pems<span class="fl">.1</span>)</span></code></pre></div>
<p>At this stage these are measurements recorded in the same instant and comparing them suggests a small degree of association:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initial instantaneous comparison</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pemsPlot</span>(vsp, em.co2, <span class="at">data=</span>pems<span class="fl">.1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">add.XYLOESSFit</span>(p, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>However, there are time offsets between the engine action, the vehicle activity and the associated emissions leaving the vehicle exhaust. Aligning <strong>vsp</strong> and <strong>em.co2</strong> reduces the offset:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#align vsp and em.co2</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">cAlign</span>(vsp<span class="sc">~</span>em.co2, pems<span class="fl">.1</span>, <span class="at">output=</span><span class="fu">c</span>(<span class="st">&quot;pems&quot;</span>, <span class="st">&quot;offset&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;offset = 2&quot;</code></pre>
<p>In this case the alignment moved <strong>em.co2</strong> two rows toward relative to <strong>vsp</strong>, and this provides a significantly stronger relationship.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#linear aligned VSP and CO2 emissions</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pemsPlot</span>(vsp, em.co2, <span class="at">data=</span>pems<span class="fl">.2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">add.XYLOESSFit</span>(p, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Please Note: This is an approximation because the offset is not fixed.</p>
</blockquote>
<p>In many cases such data is often binned and reported on this basis:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#VSP binning using the Frey et al (2002) 14 mode bins method. </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>ncsu<span class="fl">.14</span> <span class="ot">&lt;-</span> <span class="fu">refVSPBin</span>(vsp, <span class="at">data=</span>pems<span class="fl">.1</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pems<span class="fl">.1</span><span class="sc">$</span>ncsu<span class="fl">.14</span>)</span></code></pre></div>
<pre><code>## MODE01 MODE02 MODE03 MODE04 MODE05 MODE06 MODE07 MODE08 MODE09 MODE10 MODE11 
##    150     58    443    123     64     58     35     23     22     11      5 
## MODE12 MODE13 MODE14   NA&#39;s 
##      3      2      2      1</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#frequency plot</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">VSPBinPlot</span>(ncsu<span class="fl">.14</span>, <span class="at">data=</span>pems<span class="fl">.1</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#emission averages plot</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">VSPBinPlot</span>(ncsu<span class="fl">.14</span>, em.co2, <span class="at">data=</span>pems<span class="fl">.1</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">plot.type=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<blockquote>
<p>Note: In this case there are relatively few measurements for bins 10 and above, and averages calculated for these are more uncertain.</p>
</blockquote>
<blockquote>
<p>See <a href="http://pems.r-forge.r-project.org/pems.utils.plots.html">[&gt;pems.utils plots]</a> or R help documentation (?pems.plots) for more about plotting <strong>pems</strong>.</p>
</blockquote>
</div>
<div id="pems-data-batching-and-reporting" class="section level1">
<h1>PEMS Data Batching and Reporting</h1>
<p>One of the great things about <strong>R</strong> is that it allows you to batch process data, for example running the same code on different sections of a single dataset or different datasets.</p>
<p>The <strong>pems.utils</strong> function <strong>summaryReport</strong> generates a summary table of some common vehicle activities parameters:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summaryReport</span>(velocity, local.time, <span class="at">data=</span>pems<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##   distance.travelled.km time.total.s avg.speed.km.h avg.running.speed.km.h
## 1              6.186056         1000        22.2698               28.78538
##   time.idle.s time.idle.pc avg.accel.m.s.s time.accel.s time.accel.pc
## 1          40            4       0.7921279          271          27.1
##   avg.decel.m.s.s time.decel.s time.decel.pc
## 1      -0.9039449          238          23.8</code></pre>
<p>If we cut that data in several subsections, we can analysis them separately and compare results:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pems<span class="fl">.1</span><span class="sc">$</span>ref <span class="ot">&lt;-</span> <span class="fu">refRow</span>(pems<span class="fl">.1</span>, <span class="at">n=</span><span class="dv">4</span>, <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(x){ </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summaryReport</span>(velocity, local.time, <span class="at">data=</span>pems<span class="fl">.1</span>[pems<span class="fl">.1</span><span class="sc">$</span>ref<span class="sc">==</span>x,])</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  })</span></code></pre></div>
<pre><code>##                        [,1]       [,2]       [,3]      [,4]      
## distance.travelled.km  1.281306   1.751556   1.674111  1.479083  
## time.total.s           251        250        250       249       
## avg.speed.km.h         18.37729   25.2224    24.1072   21.38434  
## avg.running.speed.km.h 22.37136   31.82727   32.03138  29.38619  
## time.idle.s            3          14         13        10        
## time.idle.pc           1.195219   5.6        5.2       4.016064  
## avg.accel.m.s.s        0.7419128  0.7680976  0.8423318 0.8117284 
## time.accel.s           79         66         71        54        
## time.accel.pc          31.4741    26.4       28.4      21.68675  
## avg.decel.m.s.s        -0.8488248 -0.7945205 -1.246612 -0.8753968
## time.decel.s           52         73         41        70        
## time.decel.pc          20.71713   29.2       16.4      28.11245</code></pre>
<p>Or if we wanted to compare several datasets:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">list</span>(pems<span class="fl">.1</span>, pems<span class="fl">.1</span>, pems<span class="fl">.1</span>, pems<span class="fl">.1</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(temp, <span class="cf">function</span>(x){ </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summaryReport</span>(velocity, local.time, <span class="at">data=</span>x)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  })</span></code></pre></div>
<pre><code>##                        [,1]       [,2]       [,3]       [,4]      
## distance.travelled.km  6.186056   6.186056   6.186056   6.186056  
## time.total.s           1000       1000       1000       1000      
## avg.speed.km.h         22.2698    22.2698    22.2698    22.2698   
## avg.running.speed.km.h 28.78538   28.78538   28.78538   28.78538  
## time.idle.s            40         40         40         40        
## time.idle.pc           4          4          4          4         
## avg.accel.m.s.s        0.7921279  0.7921279  0.7921279  0.7921279 
## time.accel.s           271        271        271        271       
## time.accel.pc          27.1       27.1       27.1       27.1      
## avg.decel.m.s.s        -0.9039449 -0.9039449 -0.9039449 -0.9039449
## time.decel.s           238        238        238        238       
## time.decel.pc          23.8       23.8       23.8       23.8</code></pre>
<p>These examples are relatively crude and there are lots of different ways to do similar in <strong>R</strong> but hopefully this helps you to start to see how <strong>R</strong> and <strong>pems.utils</strong> could help you to analysis data more quickly and easily…</p>
<blockquote>
<p>For further information on these and other <strong>pems.utils</strong> functions, see in-package documentation.</p>
</blockquote>
<blockquote>
<p>Any thoughts, suggestions or problems, please let me know <a href="mailto:karl.ropkins@gmail.com">[&gt;email me]</a>.</p>
</blockquote>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
